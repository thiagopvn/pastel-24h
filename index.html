<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<<<<<<< HEAD
    <title>Pastel 24h - Sistema de Controle</title>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-messaging.js"></script>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="src/css/styles.css" rel="stylesheet">
    <link href="src/css/notifications.css" rel="stylesheet">
    
    <!-- Firebase Config -->
    <script src="src/js/firebase-config.js"></script>
</head>
<body>
    <!-- Container de Notificações -->
    <div class="notifications-container"></div>
    
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-store"></i>
                Pastel 24h
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" id="homeLink">
                            <i class="fas fa-home"></i> Início
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="turnosLink">
                            <i class="fas fa-clock"></i> Turnos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="relatoriosLink">
                            <i class="fas fa-chart-bar"></i> Relatórios
                        </a>
                    </li>
                </ul>
                <div class="d-flex align-items-center">
                    <div class="position-relative me-3">
                        <button class="btn btn-outline-light" id="notificationsButton">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                        </button>
                    </div>
                    <div class="dropdown">
                        <button class="btn btn-outline-light dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown">
                            <i class="fas fa-user"></i>
                            <span id="userName">Usuário</span>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#" id="profileLink">
                                <i class="fas fa-user-cog"></i> Perfil
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" id="logoutLink">
                                <i class="fas fa-sign-out-alt"></i> Sair
                            </a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
        <div id="mainContent">
            <!-- Conteúdo será carregado dinamicamente -->
        </div>
    </div>

    <!-- Modal de Notificações -->
    <div class="modal fade" id="notificationsModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Notificações</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-between mb-3">
                        <button class="btn btn-sm btn-outline-primary" id="markAllReadButton">
                            <i class="fas fa-check-double"></i> Marcar todas como lidas
                        </button>
                        <button class="btn btn-sm btn-outline-danger" id="clearAllButton">
                            <i class="fas fa-trash"></i> Limpar todas
                        </button>
                    </div>
                    <ul class="notifications-list" id="notificationsList">
                        <!-- Notificações serão carregadas dinamicamente -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="src/js/validation.js"></script>
    <script src="src/js/backup.js"></script>
    <script src="src/js/audit.js"></script>
    <script src="src/js/error-handler.js"></script>
    <script src="src/js/app.js"></script>
=======
    <title>Login - Controle de Caixa Pastelaria 24h</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/style.css">
    <!-- Firebase App (Core) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <!-- Firebase Authentication -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <!-- Firebase Firestore (Necessário para auth.js buscar a role do usuário) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <!-- Você pode adicionar um CSS customizado se necessário -->
    <!-- <link rel="stylesheet" href="css/style.css"> -->
    <style>
        /* Estilo para simular uma imagem de fundo ou cor temática */
        body {
            background: linear-gradient(to right, #fbbf24, #f97316); /* Gradiente laranja/amarelo */
        }
        /* Customização adicional para o card de login se desejar */
        .login-card-custom {
            /* Exemplo: box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); */
        }
    </style>
</head>
<body class="flex items-center justify-center h-screen p-4">

    <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md login-card-custom transform transition-all hover:scale-105 duration-300">
        <div class="text-center mb-8">
            <img src="https://via.placeholder.com/100x100.png?text=Pastel" alt="Logo Pastelaria" class="mx-auto mb-4 rounded-full shadow-lg">
            <!-- Substitua "https://via.placeholder.com/..." pelo caminho do seu logo -->
            <h1 class="text-3xl font-bold text-orange-600">Pastelaria 24h</h1>
            <p class="text-gray-500">Bem-vindo! Faça login para continuar.</p>
        </div>

        <form id="loginForm" class="space-y-6">
            <div>
                <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                          <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" />
                          <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" />
                        </svg>
                    </div>
                    <input type="email" id="email" name="email" required
                           class="focus:ring-orange-500 focus:border-orange-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md p-3"
                           placeholder="seuemail@exemplo.com">
                </div>
            </div>

            <div>
                <label for="password" class="block text-sm font-medium text-gray-700">Senha</label>
                 <div class="mt-1 relative rounded-md shadow-sm">
                     <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                          <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <input type="password" id="password" name="password" required
                           class="focus:ring-orange-500 focus:border-orange-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md p-3"
                           placeholder="••••••••">
                </div>
            </div>

            <button type="submit" id="btnLogin"
                    class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition duration-150 ease-in-out">
                <span class="button-text">Entrar</span>
                <svg class="animate-spin h-5 w-5 text-white ml-2 hidden" id="loginSpinner" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </button>

            <p id="loginError" class="text-red-500 text-sm mt-4 text-center font-medium"></p>
        </form>

        <div class="mt-6 text-center">
            <p class="text-sm text-gray-500">
                Problemas para acessar? <a href="#" class="font-medium text-orange-600 hover:text-orange-500">Contate o suporte</a>.
            </p>
        </div>
    </div>

    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loginForm = document.getElementById('loginForm');
            const btnLogin = document.getElementById('btnLogin');
            const loginSpinner = document.getElementById('loginSpinner');
            const buttonText = btnLogin.querySelector('.button-text');
            const loginError = document.getElementById('loginError');

            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    // Mostrar spinner e desabilitar botão
                    buttonText.classList.add('hidden');
                    loginSpinner.classList.remove('hidden');
                    btnLogin.disabled = true;
                    loginError.textContent = '';


                    const email = loginForm.email.value;
                    const password = loginForm.password.value;

                    // A lógica de login e redirecionamento já está em auth.js
                    // A função auth.signInWithEmailAndPassword será chamada lá.
                    // Precisamos apenas simular um pouco do processo visual aqui se desejado,
                    // ou deixar auth.js cuidar do feedback de erro também.
                    // Por agora, auth.js já tem um 'loginError.textContent', então
                    // apenas chamamos o método do firebase auth.

                    try {
                        // A chamada de signInWithEmailAndPassword já é feita dentro do auth.js,
                        // no listener do form 'loginForm' (que é este mesmo formulário).
                        // O auth.js vai capturar o submit e fazer a autenticação.
                        // O código abaixo não é necessário se auth.js estiver configurado para o mesmo form.

                        // Se o listener em auth.js estiver no mesmo 'loginForm',
                        // este listener pode ser simplificado ou removido,
                        // OU, o listener em auth.js é modificado para não ser
                        // um event listener de 'submit' e sim uma função chamada aqui.

                        // Para manter como está e para que auth.js controle, apenas removemos
                        // a chamada explícita de signInWithEmailAndPassword daqui.
                        // Apenas garantimos que o spinner seja escondido e o botão reabilitado
                        // em caso de erro capturado *pelo auth.js*.
                        
                        // No entanto, o auth.js atual já busca o loginError.
                        // Para que o spinner funcione aqui, precisamos interceptar e
                        // fazer a chamada aqui.

                        await auth.signInWithEmailAndPassword(email, password);
                        // Se sucesso, auth.js cuidará do redirecionamento através do onAuthStateChanged.
                        // Não precisa fazer nada aqui após o sucesso, pois o onAuthStateChanged disparará.
                        // O spinner será "interrompido" pelo redirecionamento.
                    } catch (error) {
                        console.error("Erro de login no index.html:", error);
                        if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {
                            loginError.textContent = 'Email ou senha inválidos.';
                        } else if (error.code === 'auth/too-many-requests') {
                            loginError.textContent = 'Muitas tentativas de login. Tente novamente mais tarde.';
                        } else {
                            loginError.textContent = 'Erro ao fazer login. Verifique sua conexão ou tente novamente.';
                        }
                        // Esconder spinner e reabilitar botão em caso de erro
                        buttonText.classList.remove('hidden');
                        loginSpinner.classList.add('hidden');
                        btnLogin.disabled = false;
                    }
                });
            }

            // Observador de estado de autenticação (já presente em auth.js, mas pode ser útil para UX inicial aqui)
            auth.onAuthStateChanged(user => {
                if (user) {
                    // Se o usuário já estiver logado (e onAuthStateChanged em auth.js já está tratando redirecionamentos),
                    // podemos opcionalmente mostrar um "Redirecionando..."
                    // mas auth.js já deve cuidar disso rapidamente.
                    // Poderia também desabilitar o formulário
                    if(btnLogin) btnLogin.disabled = true;
                    if(buttonText) buttonText.textContent = 'Redirecionando...';
                } else {
                    // Garante que o botão esteja habilitado se não houver usuário
                    if(btnLogin) btnLogin.disabled = false;
                    if(buttonText) {
                        buttonText.classList.remove('hidden');
                        buttonText.textContent = 'Entrar';
                    }
                    if(loginSpinner) loginSpinner.classList.add('hidden');
                }
            });
        });
    </script>

>>>>>>> c666202 (Initial commit)
</body>
</html>